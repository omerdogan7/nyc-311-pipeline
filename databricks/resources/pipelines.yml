resources:
  pipelines:
    nyc_311_pipeline:
      name: nyc_311_pipeline_${bundle.target}
      catalog: ${var.catalog}
      schema: bronze      
      
      serverless: true
      
      configuration:
        
        bundle.catalog: ${var.catalog}
        bundle.bronze_bucket: ${var.bronze_bucket}
        bundle.data_bucket: ${var.data_bucket}
        bundle.bronze_volume_path: ${var.bronze_volume_path}
        bundle.silver_volume_path: ${var.silver_volume_path}
        bundle.gold_volume_path: ${var.gold_volume_path}
        
        # DLT settings
        pipelines.autoCreateManagedSchema: "true"

        spark.databricks.unityCatalog.checkPathOverlap: "false"

      libraries:
        - file:
            path: ./src/bronze/bronze_layer.py
        - file:
            path: ./src/silver/silver_layer.py
      
      continuous: false
      development: true